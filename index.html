<!DOCTYPE html>
<html lang="es">
    <head>
        <title>BingoJS</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="index.css">
        <link rel="icon" href="assets/bingo.png" type="image/x-icon">    
    </head>
    <body>
        <header>
            <div id="logo">
                <img src="assets/bingo.png" alt="bingojs">
            </div>
            <div class="tituloDiv">
                <h1>BINGOJS</h1>
            </div>
            <div id="redessociales" >
                <a href="https://github.com/Sergiioog" target="_blank" rel="noopener noreferrer" class="mr-5">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="red" class="bi bi-github" viewBox="0 0 16 16">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8"/>
                    </svg>
                </a>
            
                <a href="https://www.linkedin.com/feed/" target="_blank" rel="noopener noreferrer" class="mr-5">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="red" class="bi bi-linkedin" viewBox="0 0 16 16">
                        <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401m-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4"/>
                    </svg>
                </a>
            
                <a href="https://twitter.com/home" target="_blank" rel="noopener noreferrer">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="red" class="bi bi-twitter-x" viewBox="0 0 16 16">
                        <path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z"/>
                    </svg>
                </a>
            </div>
        </header>
        <main>
           <div id="bolas">
                <div id="bolasSacadas">
                    <div id="tablero"> <!--Tablero que se va rellenando a medida que salgan los numeros-->
                        <div class="cuadrado" id="0"><p>0</p></div>
                        <div class="cuadrado" id="1"><p>1</p></div>
                        <div class="cuadrado" id="2"><p>2</p></div>
                        <div class="cuadrado" id="3"><p>3</p></div>
                        <div class="cuadrado" id="4"><p>4</p></div>
                        <div class="cuadrado" id="5"><p>5</p></div>
                        <div class="cuadrado" id="6"><p>6</p></div>
                        <div class="cuadrado" id="7"><p>7</p></div>
                        <div class="cuadrado" id="8"><p>8</p></div>
                        <div class="cuadrado" id="9"><p>9</p></div>
                        <div class="cuadrado" id="10"><p>10</p></div>
                        <div class="cuadrado" id="11"><p>11</p></div>
                        <div class="cuadrado" id="12"><p>12</p></div>
                        <div class="cuadrado" id="13"><p>13</p></div>
                        <div class="cuadrado" id="14"><p>14</p></div>
                        <div class="cuadrado" id="15"><p>15</p></div>
                        <div class="cuadrado" id="16"><p>16</p></div>
                        <div class="cuadrado" id="17"><p>17</p></div>
                        <div class="cuadrado" id="18"><p>18</p></div>
                        <div class="cuadrado" id="19"><p>19</p></div>
                        <div class="cuadrado" id="20"><p>20</p></div>
                        <div class="cuadrado" id="21"><p>21</p></div>
                        <div class="cuadrado" id="22"><p>22</p></div>
                        <div class="cuadrado" id="23"><p>23</p></div>
                        <div class="cuadrado" id="24"><p>24</p></div>
                        <div class="cuadrado" id="25"><p>25</p></div>
                        <div class="cuadrado" id="26"><p>26</p></div>
                        <div class="cuadrado" id="27"><p>27</p></div>
                        <div class="cuadrado" id="28"><p>28</p></div>
                        <div class="cuadrado" id="29"><p>29</p></div>
                        <div class="cuadrado" id="30"><p>30</p></div>
                        <div class="cuadrado" id="31"><p>31</p></div>
                        <div class="cuadrado" id="32"><p>32</p></div>
                        <div class="cuadrado" id="33"><p>33</p></div>
                        <div class="cuadrado" id="34"><p>34</p></div>
                        <div class="cuadrado" id="35"><p>35</p></div>
                        <div class="cuadrado" id="36"><p>36</p></div>
                        <div class="cuadrado" id="37"><p>37</p></div>
                        <div class="cuadrado" id="38"><p>38</p></div>
                        <div class="cuadrado" id="39"><p>39</p></div>
                        <div class="cuadrado" id="40"><p>40</p></div>
                        <div class="cuadrado" id="41"><p>41</p></div>
                        <div class="cuadrado" id="42"><p>42</p></div>
                        <div class="cuadrado" id="43"><p>43</p></div>
                        <div class="cuadrado" id="44"><p>44</p></div>
                        <div class="cuadrado" id="45"><p>45</p></div>
                        <div class="cuadrado" id="46"><p>46</p></div>
                        <div class="cuadrado" id="47"><p>47</p></div>
                        <div class="cuadrado" id="48"><p>48</p></div>
                        <div class="cuadrado" id="49"><p>49</p></div>
                        <div class="cuadrado" id="50"><p>50</p></div>
                        <div class="cuadrado" id="51"><p>51</p></div>
                        <div class="cuadrado" id="52"><p>52</p></div>
                        <div class="cuadrado" id="53"><p>53</p></div>
                        <div class="cuadrado" id="54"><p>54</p></div>
                        <div class="cuadrado" id="55"><p>55</p></div>
                        <div class="cuadrado" id="56"><p>56</p></div>
                        <div class="cuadrado" id="57"><p>57</p></div>
                        <div class="cuadrado" id="58"><p>58</p></div>
                        <div class="cuadrado" id="59"><p>59</p></div>
                        <div class="cuadrado" id="60"><p>60</p></div>
                        <div class="cuadrado" id="61"><p>61</p></div>
                        <div class="cuadrado" id="62"><p>62</p></div>
                        <div class="cuadrado" id="63"><p>63</p></div>
                        <div class="cuadrado" id="64"><p>64</p></div>
                        <div class="cuadrado" id="65"><p>65</p></div>
                        <div class="cuadrado" id="66"><p>66</p></div>
                        <div class="cuadrado" id="67"><p>67</p></div>
                        <div class="cuadrado" id="68"><p>68</p></div>
                        <div class="cuadrado" id="69"><p>69</p></div>
                        <div class="cuadrado" id="70"><p>70</p></div>
                        <div class="cuadrado" id="71"><p>71</p></div>
                        <div class="cuadrado" id="72"><p>72</p></div>
                        <div class="cuadrado" id="73"><p>73</p></div>
                        <div class="cuadrado" id="74"><p>74</p></div>
                        <div class="cuadrado" id="75"><p>75</p></div>
                        <div class="cuadrado" id="76"><p>76</p></div>
                        <div class="cuadrado" id="77"><p>77</p></div>
                        <div class="cuadrado" id="78"><p>78</p></div>
                        <div class="cuadrado" id="79"><p>79</p></div>
                        <div class="cuadrado" id="80"><p>80</p></div>
                        <div class="cuadrado" id="81"><p>81</p></div>
                        <div class="cuadrado" id="82"><p>82</p></div>
                        <div class="cuadrado" id="83"><p>83</p></div>
                        <div class="cuadrado" id="84"><p>84</p></div>
                        <div class="cuadrado" id="85"><p>85</p></div>
                        <div class="cuadrado" id="86"><p>86</p></div>
                        <div class="cuadrado" id="87"><p>87</p></div>
                        <div class="cuadrado" id="88"><p>88</p></div>
                        <div class="cuadrado" id="89"><p>89</p></div>
                        <div class="cuadrado" id="90"><p>90</p></div>
                    </div>
                    
                    
                </div>
                <div id="bolaActual"> <!--Darle estilos-->
                    <div id="bola">
                        <p id="bolita"></p>
                    </div>
                </div>
               
               
           </div>
           <div id="bingo" style="display:none;">
                <p>FELICIDADES HAS HECHO BINGO</p>
            </div>
           <div class="divCartones">
                <div id="divBoton">
                    <button onclick="creaCarton()">COMPRAR CARTÓN</button> <!--Boton para comprar el carton-->
                    <button onclick="eliminaCarton()">DESHACER COMPRA</button> <!--Boton para eliminar el carton-->
                </div>  
           </div>
     
           
           
        </main>
        <script>
            /*Sección de constantes*/
            const divCartones = document.querySelector('.divCartones'); //Div donde salen los cartones
            let bingo = document.querySelector('#bingo'); //Pantalla de ganar bingo
            let arrayNumCarton = []; 
            let contadorCartones = 0;
            
            /*Función que crea los cartones*/
            function creaCarton() {
                if(contadorCartones < 1) { //Si no hay ningun carton que lo cree (no he podido hacer mas cartones funcionales a tiempo) 
                    var carton = document.createElement('div'); /*Crea un elemento div y lo asigna a la variable carton*/
                    carton.innerHTML = `
                        <div class="divCarton">
                            <div class="carton">
                                <div id="fila1">
                                        <div class="recuadro" id="pos1">1</div>
                                        <div class="recuadro" ></div>
                                        <div class="recuadro" id="pos4">1</div>
                                        <div class="recuadro"></div>
                                        <div class="recuadro" id="pos7">1</div>
                                        <div class="recuadro"></div>
                                        <div class="recuadro" id="pos10">1</div>
                                        <div class="recuadro"></div>
                                        <div class="recuadro" id="pos13">1</div>
                                </div>
                                <div id="fila2">
                                        <div class="recuadro"></div>
                                        <div class="recuadro" id="pos3">1</div>
                                        <div class="recuadro"></div>
                                        <div class="recuadro" id="pos6">1</div>
                                        <div class="recuadro"></div>
                                        <div class="recuadro" id="pos9">1</div>
                                        <div class="recuadro"></div>
                                        <div class="recuadro" id="pos12">1</div>
                                        <div class="recuadro"></div>
                                </div>
                                <div id="fila3">
                                        <div class="recuadro" id="pos2">1</div>
                                        <div class="recuadro"></div>
                                        <div class="recuadro"  id="pos5">1</div>
                                        <div class="recuadro"></div>
                                        <div class="recuadro"  id="pos8">1</div>
                                        <div class="recuadro"></div>
                                        <div class="recuadro"  id="pos11">1</div>
                                        <div class="recuadro"></div>
                                        <div class="recuadro" id="pos14">1</div>
                                </div>
                            </div>
                        </div>
                    `;
                        
                   

                        
                    /*Le damos unos rangos de valores aleatorios a cada casilla*/
                    arrayNumCarton.push(parseInt(carton.querySelector('#pos1').textContent = Math.floor(Math.random() * 10)));
                    arrayNumCarton.push(parseInt(carton.querySelector('#pos2').textContent = Math.floor(Math.random() * 10)));
                    
                    arrayNumCarton.push(parseInt(carton.querySelector('#pos3').textContent = Math.floor(Math.random() * 10) + 10));
                    
                    arrayNumCarton.push(parseInt(carton.querySelector('#pos4').textContent = Math.floor(Math.random() * 10) + 20));
                    arrayNumCarton.push(parseInt(carton.querySelector('#pos5').textContent = Math.floor(Math.random() * 10) + 20));
                    
                    arrayNumCarton.push(parseInt(carton.querySelector('#pos6').textContent = Math.floor(Math.random() * 10) + 30));

                    arrayNumCarton.push(parseInt(carton.querySelector('#pos7').textContent = Math.floor(Math.random() * 10) + 40));
                    arrayNumCarton.push(parseInt(carton.querySelector('#pos8').textContent = Math.floor(Math.random() * 10) + 40));

                    arrayNumCarton.push(parseInt(carton.querySelector('#pos9').textContent = Math.floor(Math.random() * 10) + 50));
                    
                    arrayNumCarton.push(parseInt(carton.querySelector('#pos10').textContent = Math.floor(Math.random() * 10) + 60));
                    arrayNumCarton.push(parseInt(carton.querySelector('#pos11').textContent = Math.floor(Math.random() * 10) + 60));

                    arrayNumCarton.push(parseInt(carton.querySelector('#pos12').textContent = Math.floor(Math.random() * 10) + 70));

                    arrayNumCarton.push(parseInt(carton.querySelector('#pos13').textContent = Math.floor(Math.random() * 10) + 80));
                    arrayNumCarton.push(parseInt(carton.querySelector('#pos14').textContent = Math.floor(Math.random() * 10) + 80));

                    divCartones.appendChild(carton); //Le añadimos los numeros al carton
                    //si se aprieta el boton de deshacer compra que se pare el contador
                    setTimeout(function() { //Time out para sacar las bolas con 1 s de retraso entre cada una
                        sacaBolas(arrayNumCarton);
                    },1000)
                    contadorCartones++
                } else {
                    console.error("Ya has comprado el numero maximo de cartones");
                }
                
                
            }

            /*Función que elimina los cartones*/
            function eliminaCarton() {
                if (contadorCartones !== 0) { // Si hay al menos un cartón
                    // Elimina el último cartón creado
                    divCartones.removeChild(divCartones.lastChild);
                    contadorCartones--; // "Resetea" el contador
                    bolita.innerText = ''; //"Elimina el valor de la bola"
                    // Resetear el color de las casillas del tablero 
                    for (let i = 0; i <= 90; i++) { //Hasta 91 porque es el numero maximo de numeros
                        let divNumero = document.getElementById(i.toString());
                        if (divNumero) {
                            divNumero.style.backgroundColor = 'white'; //Cambiamos los divs a blanco
                        }
                    }

                } else {
                    console.error("Compra primero un cartón para poder eliminarlo");
                }
            }

            function sacaBolas(arrayNumCarton) {
                let numerosRepetidos = [];
                let contadorBolas = 0;
                let casillaMarcada = 0; // Reiniciar el contador en cada iteración

                function generarNumero() {
                    let numeroRandom; //Numer random de la bola
                    
    
                    do {
                        numeroRandom = Math.floor(Math.random() * 91); //Hace un nuevo numero random siempre y cuando no se incluya en numeros Repetidos
            
                       
        
                        for (let i = 0; i < arrayNumCarton.length; i++) { //Desde 0 hasta la longitud de los numeros contenidos del carton
                            if (numeroRandom === arrayNumCarton[i]) {
                                let divCasilla = document.getElementById(`pos${i + 1}`);
                                if (divCasilla) {
                                    divCasilla.style.backgroundColor = 'green'; //Se cambia a color verde si acierta
                                    if(!numerosRepetidos.includes(numeroRandom)){ //Su no incluye el numero random que suba el contador (para que si ej: sale el 27 y ya estaba en verde no repita y se cuente 2 veces)
                                        casillaMarcada++;
                                        console.log(`Valor de casilla: ${casillaMarcada}`);
                                        if (casillaMarcada === 14 ) { //Si se completan los 14 numeros
                                            bingo.style.display = "block"; //que salga el cartel del bingo
                                        }
                                    }
                                  
                                    break; // Salir del bucle al encontrar una coincidencia
                                }
                            }
                        }
                        

                    } while (numerosRepetidos.includes(numeroRandom));

                    
            
                    numerosRepetidos.push(numeroRandom); //Meter el numero random en numeros Repetidos para que no vuelva a salir
                    contadorBolas++;
                    asignaNumero(numeroRandom);
            
                    if (contadorBolas < 91) {
                        setTimeout(generarNumero, 2000); // Espera 2 segundos antes de generar el próximo número
                    }
                }
            
                // Iniciar el proceso
                generarNumero();
            }
            
            
            
            function asignaNumero(numero) { //Asignar el numero a la bolita
                
                let bolita = document.querySelector('#bolita');
                let divCasilla = document.getElementById(numero.toString());
                if (divCasilla) {
                    bolita.innerText = numero; //El texto de la bola
                    divCasilla.innerHTML = `<p>${numero}</p>`; //Que vaya creando p con el valor del numero para que se vayan cambiando
                    divCasilla.style.backgroundColor = 'green'; //que se vayan poniendo en verde a medida que salen
                }
            }
           
            
        
      
                
            
                
        </script>

    </body>
</html>